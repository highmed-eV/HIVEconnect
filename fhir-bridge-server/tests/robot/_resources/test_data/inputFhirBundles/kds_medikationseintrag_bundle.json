{
    "resourceType": "Bundle",
    "id": "kds-medikationseintrag-bundle",
    "type": "transaction",
    "entry": [
        {
            "fullUrl": "List.example-medication-list",
            "resource": {
                "resourceType": "List",
                "id": "example-medication-list",
                "meta": {
                    "profile": [
                        "https://www.medizininformatik-initiative.de/fhir/core/modul-medikation/StructureDefinition/medikationsliste"
                    ]
                },
                "identifier": [
                    {
                        "use": "official",
                        "system": "urn:uuid:4fdd7b11-0145-4fc7-8640-f4331a726014",
                        "value": "medlist-001"
                    }
                ],
                "status": "current",
                "mode": "snapshot",
                "code": {
                    "coding": [
                        {
                            "system": "http://terminology.hl7.org/CodeSystem/list-example-use-codes",
                            "code": "medications",
                            "display": "Medication list"
                        },
                        {
                            "system": "http://ihe-d.de/CodeSystems/FallkontextBeiDokumentenerstellung",
                            "code": "E210",
                            "display": "station√§re Aufnahme"
                        }
                    ],
                    "text": "Medication list for admission"
                },
                "subject": {
                    "reference": "Patient/{{patientId_fhir-server}}"
                },
                "encounter": {
                    "reference": "Encounter/encounter-12345",
                    "display": "Routine Checkup"
                },
                "date": "2024-08-22",
                "entry": [
                    {
                        "item": {
                            "reference": "MedicationStatement/example-medicationstatement",
                            "display": "Crocin 500mg tablet"
                        }
                    }
                ]
            },
            "request": {
                "method": "POST",
                "url": "List"
            }
        },
        {
            "fullUrl": "MedicationStatement/example-medicationstatement",
            "resource": {
                "resourceType": "MedicationStatement",
                "id": "example-medicationstatement",
                "meta": {
                    "profile": [
                        "https://www.medizininformatik-initiative.de/fhir/core/modul-medikation/StructureDefinition/MedicationStatement"
                    ]
                },
                "identifier": [
                    {
                        "system": "http://localhost:8888/fhir-bridge/fhir/identifiers/medication-statement",
                        "value": "MS123456"
                    }
                ],
                "basedOn": [
                    {
                        "reference": "MedicationRequest/medicationrequest-lab-id-1234",
                        "display": "Medication request for Aspirin 75 mg oral tablet"
                    }
                ],
                "partOf": [
                    {
                        "reference": "MedicationAdministration/medicationAdministration-lab-id-1234",
                        "display": "example-partOf-medication-administration"
                    }
                ],
                "status": "active",
                //"medicationReference": {
                //    "reference": "Medication/med-crocin",
                //    "display": "Crocin 500mg tablet"
                //},
                "statusReason": [
                    {
                        "coding": [
                            {
                                "system": "http://snomed.info/sct",
                                "code": "50621000087108",
                                "display": "Recommendation to restart drug treatment"
                            }
                        ],
                        "text": "Recommendation to restart drug treatment"
                    }
                ],
                "category": {
                    "coding": [
                        {
                            "system": "http://terminology.hl7.org/CodeSystem/medication-statement-category",
                            "code": "inpatient",
                            "display": "Inpatient"
                        }
                        //{
                        //  "system": "http://ihe-d.de/CodeSystems/FallkontextBeiDokumentenerstellung",
                        //  "code": "Ambulant",
                        //  "display": "Ambulant"
                        //}
                    ],
                    "text": "category"
                },
                "medicationCodeableConcept": {
                    "coding": [
                        {
                            "system": "http://fhir.de/CodeSystem/ifa/pzn",
                            "code": "04825604",
                            "display": "Aspirin 75 mg oral tablet"
                        },
                        {
                            "system": "http://fhir.de/CodeSystem/bfarm/atc",
                            "code": "B01AC06",
                            "display": "Acetylsalicylic acid (Aspirin)"
                        },
                        {
                            "system": "http://www.whocc.no/atc",
                            "code": "N02BE01",
                            "display": "Paracetamol"
                        }
                    ],
                    "text": "Oral tablet"
                },
                "subject": {
                    "identifier": {
                        "system": "urn:ietf:rfc:4122",
                        "value": "4c7d0173-7378-42b2-a9fa-64cd2664674f"
                    }
                },
                "context": {
                    "reference": "Encounter/2145985c-5036-4500-9a1b-12bd96687072"
                },
                "effectiveDateTime": "2024-08-21",
                "dateAsserted": "2024-08-21",
                "informationSource": {
                    "reference": "Practitioner/example-practitioner"
                },
                "reasonCode": [
                    {
                        "coding": [
                            {
                                "system": "http://snomed.info/sct",
                                "code": "13644009",
                                "display": "Hypercholesterolemia"
                            }
                        ],
                        "text": "High cholesterol"
                    }
                ],
                "reasonReference": [
                    {
                        "reference": "Condition/example-condition"
                    }
                ],
                "note": [
                    {
                        "text": "Patient reports high temperature."
                    }
                ],
                "dosage": [
                    {
                        "text": "1 tablet daily",
                        "sequence": 1,
                        "timing": {
                            "repeat": {
                                "frequency": 2,
                                "period": 1,
                                "periodUnit": "d",
                                "when": [
                                    "AC"
                                ],
                                "offset": 120,
                                "duration": 30,
                                "durationUnit": "d"
                            }
                        },
                        "route": {
                            "coding": [
                                {
                                    "system": "http://standardterms.edqm.eu",
                                    "code": "20009000",
                                    "display": "Epidural use"
                                },
                                {
                                    "system": "http://snomed.info/sct",
                                    "code": "26643006",
                                    "display": "Oral route"
                                }
                                //{
                                //    "system": "http://terminology.hl7.org/CodeSystem/v3-RouteOfAdministration",
                                //    "code": "PO",
                                //    "display": "Swallow, oral"
                                //}
                            ]
                        },
                        "site": {
                            "coding": [
                                {
                                    "system": "http://snomed.info/sct",
                                    "code": "368208006",
                                    "display": "Left upper arm structure"
                                }
                            ]
                        },
                        "asNeededBoolean": true,
                        "doseAndRate": [
                            {
                                "doseQuantity": {
                                    "value": 81,
                                    "unit": "mg",
                                    "system": "http://unitsofmeasure.org",
                                    "code": "mg"
                                }
                            }
                        ],
                        "maxDosePerPeriod": {
                            "numerator": {
                                "value": 250,
                                "unit": "mg",
                                "system": "http://unitsofmeasure.org",
                                "code": "mg"
                            },
                            "denominator": {
                                "value": 8,
                                "unit": "h",
                                "system": "http://unitsofmeasure.org",
                                "code": "h"
                            }
                        },
                        "maxDosePerAdministration": {
                            "value": 250,
                            "unit": "mg",
                            "system": "http://unitsofmeasure.org",
                            "code": "mg"
                        }

                    }
                ]
            },
            "request": {
                "method": "POST",
                "url": "MedicationStatement"
            }
        },
        {
            "fullUrl": "Medication/med-crocin",
            "resource": {
                "resourceType": "Medication",
                "id": "med-crocin",
                "meta": {
                    "profile": [
                        "https://www.medizininformatik-initiative.de/fhir/core/modul-medikation/StructureDefinition/Medication"
                    ]
                },
                "code": {
                    "coding": [
                        {
                            "system": "http://www.whocc.no/atc",
                            "code": "M01AE02",
                            "display": "naproxen"
                        }
                    ],
                    "text": "naproxen tablet"
                },
                "form": {
                    "coding": [
                        {
                            "system": "http://standardterms.edqm.eu",
                            "code": "10219000",
                            "display": "Tablet"
                        }
                    ]
                },
                "amount": {
                    "numerator": {
                        "value": 100,
                        "unit": "mg"
                    },
                    "denominator": {
                        "value": 1,
                        "unit": "tablet"
                    }
                },
                "ingredient": [
                    {
                        "itemReference": {
                            "reference": "Medication/active-ingredient-relationship"
                        },
                        "strength": {
                            "numerator": {
                                "value": 500,
                                "unit": "mg",
                                "system": "http://unitsofmeasure.org",
                                "code": "mg"
                            },
                            "denominator": {
                                "value": 1,
                                "unit": "tablet",
                                "system": "http://unitsofmeasure.org",
                                "code": "tablet"
                            }
                        },
                        "isActive": true
                    }
                ]
            },
            "request": {
                "method": "POST",
                "url": "Medication"
            }
        },
        {
            "fullUrl": "urn:uuid:active-ingredient-relationship",
            "resource": {
                "resourceType": "Medication",
                "id": "active-ingredient-relationship",
                "meta": {
                    "profile": [
                        "https://www.medizininformatik-initiative.de/fhir/core/modul-medikation/StructureDefinition/Medication"
                    ]
                },
                "code": {
                    "coding": [
                        {
                            "system": "http://www.whocc.no/atc",
                            "code": "N02BE01",
                            "display": "Paracetamol"
                        }
                    ],
                    "text": "Paracetamol oral ingredient"
                },
                "amount": {
                    "numerator": {
                        "value": 100,
                        "unit": "mg"
                    },
                    "denominator": {
                        "value": 1,
                        "unit": "tablet"
                    }
                },
                "ingredient": [
                    {
                        "itemCodeableConcept": {
                            "coding": [
                                {
                                    "system": "http://www.whocc.no/atc",
                                    "code": "N02BE01",
                                    "display": "Paracetamol"
                                }
                            ],
                            "text": "Paracetamol oral"
                        },
                        "strength": {
                            "numerator": {
                                "value": 13,
                                "unit": "mg",
                                "system": "http://unitsofmeasure.org",
                                "code": "mg"
                            },
                            "denominator": {
                                "value": 1,
                                "unit": "tablet",
                                "system": "http://unitsofmeasure.org",
                                "code": "tablet"
                            }
                        }
                    }
                ],
                "manufacturer": {
                    "reference": "Organization/manufacturer-organization"
                },
                "batch": {
                    "lotNumber": "Batch 1",
                    "expirationDate": "2022-02-03T04:05:06Z"
                }
            },
            "request": {
                "method": "POST",
                "url": "Medication"
            }
        },
        {
            "fullUrl": "Encounter/encounter-12345",
            "resource": {
                "resourceType": "Encounter",
                "id": "encounter-12345",
                "class": {
                    "code": "AMB",
                    "display": "ambulatory",
                    "system": "http://terminology.hl7.org/CodeSystem/v3-ActCode"
                },
                "identifier": [
                    {
                        "use": "official",
                        "type": {
                            "coding": [
                                {
                                    "system": "http://terminology.hl7.org/CodeSystem/v2-0203",
                                    "code": "VN",
                                    "display": "Visit number"
                                }
                            ]
                        },
                        "system": "http://hospital.smarthealthit.org",
                        "value": "encounter-id-1245"
                    }
                ],
                "status": "finished",
                "subject": {
                    "reference": "Patient/{{patientId_fhir-server}}"
                },
                "period": {
                    "start": "2024-08-21T09:00:00+01:00",
                    "end": "2024-08-21T09:30:00+01:00"
                }
            },
            "request": {
                "method": "POST",
                "url": "Encounter"
            }
        },
        {
            "fullUrl": "urn:uuid:00000000-0000-0000-0000-000000000003",
            "request": {
                "method": "POST",
                "url": "Organization"
            },
            "resource": {
                "resourceType": "Organization",
                "id": "5678",
                "name": "Example Health Clinic",
                "identifier": [
                    {
                        "system": "http://hl7.org/fhir/identifier",
                        "value": "ORG-12345"
                    }
                ]
            }
        },
        {
            "fullUrl": "urn:uuid:00000000-0000-0000-0000-000000000007",
            "request": {
                "method": "POST",
                "url": "Organization"
            },
            "resource": {
                "resourceType": "Organization",
                "id": "manufacturer-organization",
                "name": "GSK (GlaxoSmithKline)",
                "identifier": [
                    {
                        "system": "http://hl7.org/fhir/identifier",
                        "value": "ORG-6789"
                    }
                ]
            }
        }
    ]
}